{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tosib/Downloads/billing-main/billing-main/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\r\nimport { Pool } from \"pg\"\r\nimport { PrismaPg } from \"@prisma/adapter-pg\"\r\n\r\ndeclare global {\r\n  var prisma: PrismaClient | undefined\r\n}\r\n\r\nconst pool = new Pool({\r\n  connectionString: process.env.DATABASE_URL,\r\n})\r\n\r\nconst adapter = new PrismaPg(pool)\r\n\r\nexport const prisma =\r\n  global.prisma ||\r\n  new PrismaClient({\r\n    adapter,\r\n  })\r\n\r\nif (process.env.NODE_ENV !== \"production\") {\r\n  global.prisma = prisma\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAMA,MAAM,OAAO,IAAI,qJAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAC5C;AAEA,MAAM,UAAU,IAAI,8NAAQ,CAAC;AAEtB,MAAM,SACX,OAAO,MAAM,IACb,IAAI,sMAAY,CAAC;IACf;AACF;AAEF,wCAA2C;IACzC,OAAO,MAAM,GAAG;AAClB"}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tosib/Downloads/billing-main/billing-main/src/pages/api/login.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from \"next\"\r\nimport { prisma } from \"../../lib/prisma\"\r\nimport bcrypt from \"bcrypt\"\r\n\r\nexport default async function handler(\r\n  req: NextApiRequest,\r\n  res: NextApiResponse\r\n) {\r\n  if (req.method !== \"POST\") {\r\n    return res.status(405).json({ error: \"Method not allowed\" })\r\n  }\r\n\r\n  const { email, password } = req.body\r\n\r\n  console.log(\"LOGIN BODY:\", { email, password })\r\n\r\n  const user = await prisma.user.findUnique({\r\n    where: { email }\r\n  })\r\n\r\n  console.log(\"USER FROM DB:\", user)\r\n\r\n  if (!user) {\r\n    console.log(\"❌ USER NOT FOUND\")\r\n    return res.status(401).json({ error: \"Invalid credentials\" })\r\n  }\r\n\r\n  console.log(\"PASSWORD HASH:\", user.passwordHash)\r\n\r\n  const valid = await bcrypt.compare(\r\n    String(password),\r\n    String(user.passwordHash)\r\n  )\r\n\r\n  console.log(\"BCRYPT RESULT:\", valid)\r\n\r\n  if (!valid) {\r\n    console.log(\"❌ PASSWORD MISMATCH\")\r\n    return res.status(401).json({ error: \"Invalid credentials\" })\r\n  }\r\n\r\n  console.log(\"✅ LOGIN SUCCESS\")\r\n\r\n  return res.status(200).json({\r\n    id: user.id,\r\n    email: user.email,\r\n    role: user.role,\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;;;;;;;AAEe,eAAe,QAC5B,GAAmB,EACnB,GAAoB;IAEpB,IAAI,IAAI,MAAM,KAAK,QAAQ;QACzB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IAC5D;IAEA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;IAEpC,QAAQ,GAAG,CAAC,eAAe;QAAE;QAAO;IAAS;IAE7C,MAAM,OAAO,MAAM,uHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE;QAAM;IACjB;IAEA,QAAQ,GAAG,CAAC,iBAAiB;IAE7B,IAAI,CAAC,MAAM;QACT,QAAQ,GAAG,CAAC;QACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAsB;IAC7D;IAEA,QAAQ,GAAG,CAAC,kBAAkB,KAAK,YAAY;IAE/C,MAAM,QAAQ,MAAM,6JAAM,CAAC,OAAO,CAChC,OAAO,WACP,OAAO,KAAK,YAAY;IAG1B,QAAQ,GAAG,CAAC,kBAAkB;IAE9B,IAAI,CAAC,OAAO;QACV,QAAQ,GAAG,CAAC;QACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAsB;IAC7D;IAEA,QAAQ,GAAG,CAAC;IAEZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAC1B,IAAI,KAAK,EAAE;QACX,OAAO,KAAK,KAAK;QACjB,MAAM,KAAK,IAAI;IACjB;AACF"}}]
}