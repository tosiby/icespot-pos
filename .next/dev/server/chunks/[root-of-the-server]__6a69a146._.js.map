{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tosib/Downloads/billing-main/billing-main/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\r\nimport { Pool } from \"pg\"\r\nimport { PrismaPg } from \"@prisma/adapter-pg\"\r\n\r\ndeclare global {\r\n  var prisma: PrismaClient | undefined\r\n}\r\n\r\nconst pool = new Pool({\r\n  connectionString: process.env.DATABASE_URL,\r\n})\r\n\r\nconst adapter = new PrismaPg(pool)\r\n\r\nexport const prisma =\r\n  global.prisma ||\r\n  new PrismaClient({\r\n    adapter,\r\n  })\r\n\r\nif (process.env.NODE_ENV !== \"production\") {\r\n  global.prisma = prisma\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAMA,MAAM,OAAO,IAAI,qJAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAC5C;AAEA,MAAM,UAAU,IAAI,8NAAQ,CAAC;AAEtB,MAAM,SACX,OAAO,MAAM,IACb,IAAI,sMAAY,CAAC;IACf;AACF;AAEF,wCAA2C;IACzC,OAAO,MAAM,GAAG;AAClB"}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tosib/Downloads/billing-main/billing-main/src/pages/api/create-sale.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from \"next\"\r\nimport { prisma } from \"../../lib/prisma\"\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  console.log(\"üí∞ CREATE SALE API HIT\")\r\n\r\n  try {\r\n    const { items, total, userId, paymentMode } = req.body\r\n\r\n    const billNo = \"BILL-\" + Date.now()\r\n\r\n    const sale = await prisma.sale.create({\r\n      data: {\r\n        billNumber: billNo,          // required column\r\n        totalAmount: total,          // required column\r\n        paymentMode: paymentMode,    // required column\r\n        total: total,\r\n        staffId: userId,\r\n\r\n        items: {\r\n          create: items.map((item:any)=>({\r\n            itemId: item.id,\r\n            qty: item.qty ?? 1,\r\n            price: item.price\r\n          }))\r\n        }\r\n      }\r\n    })\r\n\r\n    console.log(\"‚úÖ SALE CREATED:\", sale)\r\n    res.status(200).json(sale)\r\n\r\n  } catch (err) {\r\n    console.log(\"‚ùå CREATE SALE ERROR:\", err)\r\n    res.status(500).json({ error: \"Failed to create sale\" })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;;;;;;AAEe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC7E,QAAQ,GAAG,CAAC;IAEZ,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,WAAW,EAAE,GAAG,IAAI,IAAI;QAEtD,MAAM,SAAS,UAAU,KAAK,GAAG;QAEjC,MAAM,OAAO,MAAM,uHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,MAAM;gBACJ,YAAY;gBACZ,aAAa;gBACb,aAAa;gBACb,OAAO;gBACP,SAAS;gBAET,OAAO;oBACL,QAAQ,MAAM,GAAG,CAAC,CAAC,OAAW,CAAC;4BAC7B,QAAQ,KAAK,EAAE;4BACf,KAAK,KAAK,GAAG,IAAI;4BACjB,OAAO,KAAK,KAAK;wBACnB,CAAC;gBACH;YACF;QACF;QAEA,QAAQ,GAAG,CAAC,mBAAmB;QAC/B,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IAEvB,EAAE,OAAO,KAAK;QACZ,QAAQ,GAAG,CAAC,wBAAwB;QACpC,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAwB;IACxD;AACF"}}]
}